This repository has an actual working directshow audio input source filter.

Simplified examples like this were pretty hard to find online, and not even the MSDN SDK examples seemed to have any audio source examples.

This one works as an audio input source, in VLC, and in graphedit, etc.

I took out all the threading constructs so that you can more easily tell what is going on.

It advertises and streams a single, 44100 khz "white noise" (well, randomly generated signal).

To see the code, open "virtual audio output replay.sln"

For further exploration, I would recommend the directshow sample "synth" which shows you how to setup a dynamic source, and is more complex.
I believe that synth cannot be used with VLC since it is "dynamic" and doesn't have GetScreenCaps, though I could be wrong about that.

Enjoy.
Questions welcome, use github messaging.

There are some other side-projects in other sub-folders within this project.  You can probably safely ignore them, stick with "virtual audio output replay.sln" and "acam/*"  

-r